/* -----------------------------------------------------------------------------
 * FFS-UI / Button
 * 结构顺序：
 *  1) 主题默认变量（theme 未载入时兜底）
 *  2) 基础样式与可访问性
 *  3) 变体（primary/secondary/dashed/text/link/ghost/icon）
 *  4) 尺寸（sm/lg/block）
 *  5) 状态（loading + spinner、disabled）
 *  6) 组合与分组（group / radio-active）
 *  7) 动效（ripple）
 *  8) 异形（clip-path）与兼容回退
 *  9) 动效偏好（prefers-reduced-motion）
 * --------------------------------------------------------------------------- */

/* 1) 主题默认变量（theme.js 缺席时的兜底） */
:root {
    /* 主色系 */
    --ffs-primary-color: #1890ff;
    --ffs-primary-hover-color: #40a9ff;
    --ffs-primary-active-color: #096dd9;

    /* 文本/边框/禁用 */
    --ffs-text-color: rgba(0, 0, 0, 0.88);
    --ffs-border-color: #d9d9d9;
    --ffs-disabled-color: rgba(0, 0, 0, 0.35);
    --ffs-disabled-bg: #f5f5f5;

    /* 次级背景（灰底/悬停） */
    --ffs-secondary-color: #f5f5f5;
    --ffs-secondary-hover-color: #f0f0f0;
    --ffs-secondary-active-color: #e6f4ff;

    /* 尺寸与圆角 */
    --ffs-border-radius-sm: 6px;
    --ffs-button-padding-y: 4px;
    --ffs-button-padding-x: 15px;
    --ffs-button-height-sm: 24px;
    --ffs-button-height-md: 32px;
    --ffs-button-height-lg: 40px;

    /* 焦点/加载/涟漪 */
    --ffs-focus-color: #1677ff;
    --ffs-loading-overlay: rgba(255, 255, 255, 0.35);
    --ffs-ripple-bg: rgba(255, 255, 255, 0.3);
}

/* 2) 基础样式与可访问性 */
.ffs-button {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    padding: var(--ffs-button-padding-y) var(--ffs-button-padding-x);
    font-size: 14px;
    height: var(--ffs-button-height-md);
    border-radius: var(--ffs-border-radius-sm);
    border: 1px solid transparent;
    background: transparent;
    color: var(--ffs-text-color);
    cursor: pointer;
    user-select: none;
    touch-action: manipulation;
    line-height: 1.5715;
    white-space: nowrap;
    box-shadow: 0 2px 0 rgba(0, 0, 0, 0.015);
    box-sizing: border-box;
    position: relative;
    /* 为涟漪定位提供基础 */
    overflow: hidden;
    /* 裁剪涟漪 */
    transition: background-color .2s, border-color .2s, box-shadow .2s, color .2s;
    outline: none;
}

.ffs-button:focus-visible {
    box-shadow: 0 0 0 3px rgba(22, 119, 255, .35), 0 2px 0 rgba(0, 0, 0, 0.015);
    border-color: var(--ffs-focus-color);
}

/* 3) 变体 */
.ffs-button-primary {
    color: #fff;
    background-color: var(--ffs-primary-color);
    border-color: var(--ffs-primary-color);
    box-shadow: 0 2px 0 rgba(24, 144, 255, 0.2);
}

.ffs-button-primary:hover {
    background-color: var(--ffs-primary-hover-color);
    border-color: var(--ffs-primary-hover-color);
    box-shadow: 0 4px 12px rgba(24, 144, 255, 0.35);
}

.ffs-button-primary:active {
    background-color: var(--ffs-primary-active-color);
    border-color: var(--ffs-primary-active-color);
    box-shadow: none;
}

.ffs-button-secondary {
    color: var(--ffs-text-color);
    background-color: var(--ffs-secondary-color);
    border-color: var(--ffs-border-color);
}

.ffs-button-secondary:hover {
    color: var(--ffs-primary-color);
    background-color: var(--ffs-secondary-hover-color);
    border-color: var(--ffs-primary-color);
}

.ffs-button-secondary:active {
    color: var(--ffs-primary-active-color);
    background-color: var(--ffs-secondary-active-color);
    border-color: var(--ffs-primary-active-color);
}

.ffs-button-dashed {
    color: var(--ffs-text-color);
    background-color: transparent;
    border-style: dashed;
    border-color: var(--ffs-border-color);
}

.ffs-button-dashed:hover {
    color: var(--ffs-primary-color);
    border-color: var(--ffs-primary-color);
}

.ffs-button-dashed:active {
    color: var(--ffs-primary-active-color);
    border-color: var(--ffs-primary-active-color);
}

.ffs-button-text {
    color: var(--ffs-text-color);
    background-color: transparent;
    border-color: transparent;
    box-shadow: none;
}

.ffs-button-text:hover {
    color: var(--ffs-primary-color);
    background-color: var(--ffs-secondary-hover-color);
}

.ffs-button-text:active {
    color: var(--ffs-primary-active-color);
    background-color: var(--ffs-secondary-active-color);
}

.ffs-button-link {
    color: var(--ffs-primary-color);
    background-color: transparent;
    border-color: transparent;
    box-shadow: none;
}

.ffs-button-link:hover {
    color: var(--ffs-primary-hover-color);
}

.ffs-button-link:active {
    color: var(--ffs-primary-active-color);
}

.ffs-button-icon {
    padding: 4px;
    border-radius: 50%;
    width: 32px;
    height: 32px;
}

/* 4) 尺寸 */
.ffs-button-sm {
    font-size: 12px;
    height: var(--ffs-button-height-sm);
    padding: 0 calc(var(--ffs-button-padding-x) * .5);
}

.ffs-button-lg {
    font-size: 16px;
    height: var(--ffs-button-height-lg);
    padding: 0 var(--ffs-button-padding-x);
}

.ffs-button-block {
    width: 100%;
    display: flex;
}

/* 5) 状态：加载（loading）与 spinner */
.ffs-button-loading {
    pointer-events: none;
    opacity: 0.85;
}

.ffs-button-loading::before {
    position: absolute;
    inset: -1px;
    /* 等价于 top/right/bottom/left:-1px */
    z-index: 1;
    display: block;
    background: var(--ffs-loading-overlay);
    border-radius: inherit;
    content: '';
    transition: opacity .2s;
}

/* 纯 CSS 微型 spinner（避免 Font Awesome 依赖） */
.ffs-button-spinner {
    width: 1em;
    height: 1em;
    margin-right: 8px;
    border: 2px solid currentColor;
    border-right-color: transparent;
    border-radius: 50%;
    display: inline-block;
    vertical-align: -2px;
    animation: ffs-button-loading .8s linear infinite;
}

@keyframes ffs-button-loading {
    to {
        transform: rotate(360deg);
    }
}

/* 5) 状态：禁用（属性与类名均生效） */
.ffs-button[disabled],
.ffs-button[disabled]:hover,
.ffs-button[disabled]:active,
.ffs-button.ffs-button-disabled,
.ffs-button.ffs-button-disabled:hover,
.ffs-button.ffs-button-disabled:active {
    color: var(--ffs-disabled-color);
    background-color: var(--ffs-disabled-bg);
    border-color: var(--ffs-border-color);
    cursor: not-allowed;
    box-shadow: none;
}

/* 6) 组合与分组 */
.ffs-button-group {
    display: inline-flex;
    align-items: center;
}

.ffs-button-group .ffs-button:not(:first-child) {
    margin-left: -1px;
    border-top-left-radius: 0;
    border-bottom-left-radius: 0;
}

.ffs-button-group .ffs-button:not(:last-child) {
    border-top-right-radius: 0;
    border-bottom-right-radius: 0;
}

.ffs-button-group-radio .ffs-button-active {
    color: #fff;
    background-color: var(--ffs-primary-color);
    border-color: var(--ffs-primary-color);
}

/* 7) 动效：涟漪 */
.ffs-button-ripple {
    position: absolute;
    background: var(--ffs-ripple-bg);
    border-radius: 50%;
    transform: scale(0);
    animation: ffs-ripple 0.6s linear forwards;
    pointer-events: none;
}

@keyframes ffs-ripple {
    to {
        transform: scale(1);
        opacity: 0;
    }
}

/* 8) 异形按钮（clip-path） */
.ffs-button-shape-circle {
    border-radius: 50%;
    padding: 0;
    width: 36px;
    height: 36px;
}

.ffs-button-shape-round {
    border-radius: 40px;
}

.ffs-button-shape-triangle {
    clip-path: polygon(50% 0%, 0% 100%, 100% 100%);
    padding: 15px 20px 10px;
    height: 40px;
    min-width: 60px;
    display: inline-flex;
    align-items: flex-end;
    justify-content: center;
}

.ffs-button-shape-trapezoid {
    clip-path: polygon(10% 0%, 90% 0%, 100% 100%, 0% 100%);
    padding: 8px 20px;
}

.ffs-button-shape-star {
    clip-path: polygon(50% 0%, 61% 35%, 98% 35%, 68% 57%, 79% 91%, 50% 70%, 21% 91%, 32% 57%, 2% 35%, 39% 35%);
    padding: 15px;
    min-width: 60px;
    min-height: 60px;
    display: inline-flex;
    align-items: center;
    justify-content: center;
}

.ffs-button-shape-heart {
    clip-path: polygon(50% 0%, 100% 35%, 100% 70%, 80% 90%, 50% 100%, 20% 90%, 0% 70%, 0% 35%, 50% 0%);
    padding: 15px;
    min-width: 60px;
    min-height: 60px;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    transform: perspective(10px) rotateX(5deg);
}

.ffs-button-shape-octagon {
    clip-path: polygon(30% 0%, 70% 0%, 100% 30%, 100% 70%, 70% 100%, 30% 100%, 0% 70%, 0% 30%);
    padding: 8px 20px;
}

.ffs-button-shape-diamond {
    clip-path: polygon(50% 0%, 100% 50%, 50% 100%, 0% 50%);
    padding: 15px;
    min-width: 60px;
    min-height: 60px;
    display: inline-flex;
    align-items: center;
    justify-content: center;
}

.ffs-button-shape-hexagon {
    clip-path: polygon(25% 0%, 75% 0%, 100% 50%, 75% 100%, 25% 100%, 0% 50%);
    padding: 8px 20px;
}

.ffs-button-shape-wave {
    clip-path: polygon(0% 40%, 20% 30%, 40% 40%, 60% 30%, 80% 40%, 100% 30%, 100% 100%, 0% 100%);
    padding: 15px 20px 8px;
    min-height: 40px;
    display: inline-flex;
    align-items: flex-end;
    justify-content: center;
}

.ffs-button-shape-custom {
    clip-path: polygon(0% 20%, 20% 0%, 80% 0%, 100% 20%, 100% 80%, 80% 100%, 20% 100%, 0% 80%);
    padding: 8px 20px;
}

/* clip-path 不支持时的回退（统一圆角回退） */
@supports not (clip-path: polygon(0 0)) {
    .ffs-button[class*="ffs-button-shape-"] {
        clip-path: none;
        border-radius: 40px;
    }
}

/* 9) 动效偏好（用户选择减少动效） */
@media (prefers-reduced-motion: reduce) {

    .ffs-button,
    .ffs-button-ripple,
    .ffs-button-spinner {
        transition: none !important;
        animation: none !important;
    }
}